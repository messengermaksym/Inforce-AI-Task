# AI Chat REST API 

Реалізація REST API для чату з підтримкою історії повідомлень та автоматичним розрахунком вартості використання токенів.

## Функціонал
- **Керування сесіями:** створення унікальних чат-сесій для розділення діалогів.
- **Контекстна пам'ять:** повноцінна підтримка історії повідомлень у межах кожної сесії.
- **Трекінг витрат:** автоматичне отримання даних про використані токени та розрахунок вартості кожного повідомлення.
- **Історія та статистика:** отримання повного логу діалогу з накопиченою вартістю всієї сесії.
- **Інтерфейс:** наявність мінімального вбудованого UI для швидкого тестування функціоналу.

## Технологічні рішення
- **API:** Обрано **Gemini API** замість OpenAI, оскільки Google надає зручні умови для розробки та тестування, тоді як OpenAI вимагає передплати навіть для початкового доступу до API.
- **AI Model:** Використано **Gemini 2.5 Flash**.
- **SDK:** Використано бібліотеку **`google-genai`** .


## Структура проекту
- `main.py` — логіка FastAPI, ендпоінти та вбудований UI для зручного тестування.
- `services.py` — конфігурація AI-клієнта та сервіс розрахунку вартості повідомлень.
- `models.py` — опис схем бази даних (Sessions та Messages) через SQLAlchemy.
- `database.py` — налаштування та підключення до бази даних SQLite.

## Встановлення та запуск
1. **Клонувати проект та встановити залежності:**
   ```bash
   pip install -r requirements.txt
   ```
2. **Налаштувати API ключ: Створіть файл .env у корені проекту та додайте ваш ключ:**
   ```bash
   GEMINI_API_KEY=ваш_ключ  
   ```
3. **Запустити сервер:**
   ```bash
   uvicorn main:app --reload  
   ```
4. **Тестування: Перейдіть за адресою http://127.0.0.1:8000/ для використання чату через UI або http://127.0.0.1:8000/docs для роботи через Swagger.**

## API Endpoints
- `POST /sessions` — створення нової чат-сесії.
- `POST /sessions/{id}/messages` — надсилання повідомлення (повертає відповідь та вартість).
- `GET /sessions/{id}/history` — перегляд усієї історії повідомлень та загальної вартості сесії.